import { MiddlewareHandlerContext } from "https://deno.land/x/fresh@1.1.4/server.ts";

export  const handler = [
  async function check_if_logged_in(req:Request, ctx: MiddlewareHandlerContext) {

    const cookie = req.headers.get("set-cookie") as string;
    console.log({cookie});
    console.log({headers: req.headers});
    const headers = new Headers();
    headers.set("cookie", cookie);

    const res: Response = await fetch(
      `http://127.0.0.1:8080/auth/checklogin`,
      {
        method: "GET",
        headers,
      },
    );

    console.log({requestCookies: res.headers.get("set-cookie")});
    console.log({res});

    // do something
    return ctx.next();
  },
];
